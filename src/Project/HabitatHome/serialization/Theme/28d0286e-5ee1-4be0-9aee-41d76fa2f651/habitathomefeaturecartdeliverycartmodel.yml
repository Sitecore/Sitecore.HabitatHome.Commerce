---
ID: "1bfeb2c8-4095-4b1d-adea-afa29270e211"
Parent: "28d0286e-5ee1-4be0-9aee-41d76fa2f651"
Template: "962b53c4-f93b-4df9-9821-415c867b8903"
Path: /sitecore/media library/Themes/Habitat Sites/Habitat Home Store/scripts/components/Cart/habitathomefeaturecartdeliverycartmodel
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: "-/media/1BFEB2C840954B1DADEAAFA29270E211.ashx?h=16&thn=1&w=16"
- ID: "40e50ed9-ba07-4702-992e-a912738d32dc"
  Hint: Blob
  BlobID: "00047a96-9186-44dd-9cf2-1ac80973baab"
  Value: 77u/DQoNCmZ1bmN0aW9uIERlbGl2ZXJ5Q2FydExpbmVJdGVtRGF0YShjYXJ0RGF0YSwgbGluZSwgY2FydCkgew0KICAgIHZhciBzZWxmID0gdGhpczsNCg0KICAgIHNlbGYuY2FydCA9IGNhcnQ7DQogICAgLy8gbGluZXMgLy8NCiAgICBzZWxmLmltYWdlID0gbGluZS5JbWFnZTsNCiAgICBzZWxmLmRpc3BsYXlOYW1lID0gbGluZS5EaXNwbGF5TmFtZTsNCg0KICAgIC8vIFRPRE86IFNjaGVtYSBzcGVjaWZpYw0KICAgIHNlbGYuY29sb3JJbmZvcm1hdGlvbiA9IGxpbmUuQ29sb3JJbmZvcm1hdGlvbjsNCiAgICBzZWxmLnNpemVJbmZvcm1hdGlvbiA9IGxpbmUuU2l6ZUluZm9ybWF0aW9uOw0KICAgIHNlbGYuc3R5bGVJbmZvcm1hdGlvbiA9IGxpbmUuU3R5bGVJbmZvcm1hdGlvbjsNCiAgICBzZWxmLmdpZnRDYXJkQW1vdW50SW5mb3JtYXRpb24gPSBsaW5lLkdpZnRDYXJkQW1vdW50SW5mb3JtYXRpb247DQogICAgc2VsZi5saW5lSXRlbURpc2NvdW50ID0gbGluZS5MaW5lRGlzY291bnQ7DQogICAgc2VsZi5xdWFudGl0eSA9IGxpbmUuUXVhbnRpdHk7DQogICAgc2VsZi5saW5lUHJpY2UgPSBsaW5lLkxpbmVQcmljZTsNCiAgICBzZWxmLmxpbmVUb3RhbCA9IGxpbmUuTGluZVRvdGFsOw0KICAgIHNlbGYuZXh0ZXJuYWxDYXJ0TGluZUlkID0gbGluZS5FeHRlcm5hbENhcnRMaW5lSWQ7DQogICAgc2VsZi5wcm9kdWN0VXJsID0gbGluZS5Qcm9kdWN0VXJsOw0KICAgIHNlbGYuZGlzY291bnRPZmZlck5hbWVzID0gbGluZS5EaXNjb3VudE9mZmVyTmFtZXM7DQogICAgc2VsZi5zaG91bGRTaG93U2F2aW5ncyA9IGtvLm9ic2VydmFibGUoc2VsZi5saW5lSXRlbURpc2NvdW50ICE9PSAiJDAuMDAiID8gdHJ1ZSA6IGZhbHNlKTsNCiAgICBzZWxmLnNob3VsZFNob3dEaXNjb3VudE9mZmVycyA9IGtvLm9ic2VydmFibGUoc2VsZi5kaXNjb3VudE9mZmVyTmFtZXMubGVuZ3RoID4gMCA/IHRydWUgOiBmYWxzZSk7DQoNCiAgICAvLyBzaGlwcGluZyAvLw0KICAgIHNlbGYuc2VsZWN0ZWRTaGlwcGluZ09wdGlvbiA9IGtvLm9ic2VydmFibGUoJzAnKTsNCg0KICAgIHNlbGYuaXNMaW5lU2hpcEFsbCA9IGtvLm9ic2VydmFibGUoY2FydERhdGEuU2hpcG1lbnRzICE9IG51bGwgJiYgY2FydERhdGEuU2hpcG1lbnRzLmxlbmd0aCA+IDEpOw0KICAgIHNlbGYuaXNMaW5lU2hpcFRvRW1haWwgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTsNCg0KICAgIC8vSXMgTGluZSBQaWNrdXAgYW5kIHBpY2t1cCBzdG9yZXMNCiAgICBzZWxmLmlzTGluZVBpY2tVcCA9IGtvLm9ic2VydmFibGUoZmFsc2UpOw0KICAgIHNlbGYubGluZVBpY2tVcFN0b3JlcyA9IGtvLm9ic2VydmFibGVBcnJheSgpOw0KDQogICAgc2VsZi5zaG93U2hpcE9wdGlvbkNvbnRlbnQgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTsNCiAgICBzZWxmLnNlbGVjdGVkU2hpcHBpbmdPcHRpb25OYW1lID0ga28ub2JzZXJ2YWJsZSgkKCcjU2VsZWN0RGVsaXZlcnlGaXJzdE1lc3NhZ2UnKS52YWwoKSk7DQogICAgc2VsZi50b2dnbGVTaGlwQ29udGVudCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgc2VsZi5zaG93U2hpcE9wdGlvbkNvbnRlbnQoIXNlbGYuc2hvd1NoaXBPcHRpb25Db250ZW50KCkpOw0KICAgIH07DQoNCiAgICBzZWxmLnNlbGVjdGVkU2hpcHBpbmdPcHRpb24uc3Vic2NyaWJlKGZ1bmN0aW9uIChvcHRpb24pIHsNCiAgICAgICAgc2VsZi5pc0xpbmVTaGlwQWxsKG9wdGlvbiA9PT0gMSk7DQogICAgICAgIHNlbGYuaXNMaW5lU2hpcFRvRW1haWwob3B0aW9uID09PSAzKTsNCg0KICAgICAgICAvL3NldCBpcyBwaWNrdXAgZm9yIGVhY2gNCiAgICAgICAgc2VsZi5pc0xpbmVQaWNrVXAob3B0aW9uID09PSAyKTsNCg0KICAgICAgICBzZWxmLnNob3dTaGlwT3B0aW9uQ29udGVudChvcHRpb24gIT09IDApOw0KDQogICAgICAgIHZhciBtYXRjaCA9IGtvLnV0aWxzLmFycmF5Rmlyc3Qoc2VsZi5zaGlwcGluZ09wdGlvbnMoKSwgZnVuY3Rpb24gKG8pIHsNCiAgICAgICAgICAgIHJldHVybiBvLlNoaXBwaW5nT3B0aW9uVHlwZS5WYWx1ZSA9PT0gb3B0aW9uOw0KICAgICAgICB9KTsNCg0KICAgICAgICBpZiAobWF0Y2ggIT0gbnVsbCkgew0KICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFNoaXBwaW5nT3B0aW9uTmFtZShtYXRjaC5OYW1lKTsNCiAgICAgICAgfQ0KICAgIH0uYmluZCh0aGlzKSk7DQoNCiAgICBzZWxmLnNoaXBwaW5nTWV0aG9kcyA9IGtvLm9ic2VydmFibGVBcnJheSgpOw0KICAgIHNlbGYuc2hpcHBpbmdNZXRob2QgPSBrby52YWxpZGF0ZWRPYnNlcnZhYmxlKCkuZXh0ZW5kKHsgcmVxdWlyZWQ6IHRydWUgfSk7DQogICAgc2VsZi5zZWxlY3RTaGlwcGluZ01ldGhvZCA9IGZ1bmN0aW9uIChzaGlwcGluZ01ldGhvZCkgew0KICAgICAgICBpZiAoc2hpcHBpbmdNZXRob2RzQXJyYXkuaW5kZXhPZihzZWxmLmV4dGVybmFsQ2FydExpbmVJZCkgPT09IC0xKSB7DQogICAgICAgICAgICBzaGlwcGluZ01ldGhvZHNBcnJheS5wdXNoKHNlbGYuZXh0ZXJuYWxDYXJ0TGluZUlkKTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICBzZWxmLnNoaXBwaW5nQWRkcmVzcyA9IGtvLnZhbGlkYXRlZE9ic2VydmFibGUobmV3IEFkZHJlc3NWaWV3TW9kZWwoeyAiRXh0ZXJuYWxJZCI6IHNlbGYuZXh0ZXJuYWxDYXJ0TGluZUlkIH0pKTsNCiAgICBzZWxmLnNlbGVjdGVkU2hpcHBpbmdBZGRyZXNzID0ga28ub2JzZXJ2YWJsZSgiVXNlT3RoZXIiKTsNCiAgICBzZWxmLnNlbGVjdGVkU2hpcHBpbmdBZGRyZXNzLnN1YnNjcmliZShmdW5jdGlvbiAoaWQpIHsNCiAgICAgICAgdmFyIG1hdGNoID0ga28udXRpbHMuYXJyYXlGaXJzdChzZWxmLmNhcnQudXNlckFkZHJlc3NlcygpLCBmdW5jdGlvbiAoYSkgew0KICAgICAgICAgICAgaWYgKGEuZXh0ZXJuYWxJZCgpID09PSBpZCAmJiBpZCAhPT0gIlVzZU90aGVyIikgew0KICAgICAgICAgICAgICAgIHJldHVybiBhOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgc2VsZi5zaGlwcGluZ01ldGhvZCgiIik7DQogICAgICAgIHNlbGYuc2hpcHBpbmdNZXRob2RzLnJlbW92ZUFsbCgpOw0KICAgICAgICBpZiAobWF0Y2ggIT0gbnVsbCkgew0KICAgICAgICAgICAgdmFyIG5ld0FkZHJlc3MgPSBtYXRjaC5jbG9uZSgpOw0KICAgICAgICAgICAgdmFyIG5ld0lkID0gc2VsZi5jYXJ0LmdldFVuaXF1ZUFkZHJlc3NJZCgpLnRvU3RyaW5nKCk7DQogICAgICAgICAgICBuZXdBZGRyZXNzLmV4dGVybmFsSWQobmV3SWQpOw0KICAgICAgICAgICAgbmV3QWRkcmVzcy5wYXJ0eUlkKG5ld0lkKTsNCiAgICAgICAgICAgIHNlbGYuc2hpcHBpbmdBZGRyZXNzKG5ld0FkZHJlc3MpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgc2VsZi5zaGlwcGluZ0FkZHJlc3MobmV3IEFkZHJlc3NWaWV3TW9kZWwoeyAiRXh0ZXJuYWxJZCI6IHNlbGYuZXh0ZXJuYWxDYXJ0TGluZUlkIH0pKTsNCiAgICAgICAgfQ0KICAgIH0uYmluZCh0aGlzKSk7DQogICAgc2VsZi5zaGlwcGluZ0FkZHJlc3NGaWVsZENoYW5nZWQgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBpbmRleCA9IHNoaXBwaW5nTWV0aG9kc0FycmF5LmluZGV4T2Yoc2VsZi5leHRlcm5hbENhcnRMaW5lSWQpOw0KICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7DQogICAgICAgICAgICBzaGlwcGluZ01ldGhvZHNBcnJheS5zcGxpY2UoaW5kZXgsIDEpOw0KICAgICAgICB9DQogICAgICAgIHNlbGYuc2hpcHBpbmdNZXRob2QoIiIpOw0KICAgICAgICBzZWxmLnNoaXBwaW5nTWV0aG9kcy5yZW1vdmVBbGwoKTsNCiAgICB9Ow0KDQogICAgc2VsZi5zaGlwcGluZ0VtYWlsID0ga28udmFsaWRhdGVkT2JzZXJ2YWJsZSgiIikuZXh0ZW5kKHsgcmVxdWlyZWQ6IHRydWUsIGVtYWlsOiB0cnVlIH0pOw0KICAgIHNlbGYuc2hpcHBpbmdFbWFpbC5zdWJzY3JpYmUoZnVuY3Rpb24gKGVtYWlsKSB7DQogICAgICAgIHZhciBpbmRleCA9IHNoaXBwaW5nTWV0aG9kc0FycmF5LmluZGV4T2Yoc2VsZi5leHRlcm5hbENhcnRMaW5lSWQpOw0KICAgICAgICBpZiAoZW1haWwudHJpbSgpLmxlbmd0aCA+IDAgJiYgaW5kZXggPT09IC0xKSB7DQogICAgICAgICAgICBzaGlwcGluZ01ldGhvZHNBcnJheS5wdXNoKHNlbGYuZXh0ZXJuYWxDYXJ0TGluZUlkKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIGlmIChlbWFpbC50cmltKCkubGVuZ3RoID09PSAwICYmIGluZGV4ICE9PSAtMSkgew0KICAgICAgICAgICAgc2hpcHBpbmdNZXRob2RzQXJyYXkuc3BsaWNlKGluZGV4LCAxKTsNCiAgICAgICAgfQ0KDQogICAgfS5iaW5kKHRoaXMpKTsNCiAgICBzZWxmLnNoaXBwaW5nRW1haWxDb250ZW50ID0ga28ub2JzZXJ2YWJsZSgiIik7DQoNCiAgICBzZWxmLnNoaXBwaW5nT3B0aW9ucyA9IGtvLm9ic2VydmFibGVBcnJheSgpOw0KICAgIGlmIChsaW5lLlNoaXBwaW5nT3B0aW9ucyAhPT0gbnVsbCkgew0KICAgICAgICAkKGxpbmUuU2hpcHBpbmdPcHRpb25zKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHNlbGYuc2hpcHBpbmdPcHRpb25zLnB1c2godGhpcyk7DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vIEhhbmRsZSBlZGl0IG1vZGUuDQogICAgICAgIGlmIChsaW5lLlNoaXBwaW5nT3B0aW9ucyAhPSBudWxsICYmIGxpbmUuU2hpcHBpbmdPcHRpb25zLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIHZhciBzaGlwcGluZ09wdGlvbiA9IGxpbmUuU2hpcHBpbmdPcHRpb25zWzBdOw0KICAgICAgICAgICAgaWYgKHNoaXBwaW5nT3B0aW9uICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBpZiAoc2hpcHBpbmdPcHRpb24uU2hpcHBpbmdPcHRpb25UeXBlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFNoaXBwaW5nT3B0aW9uKHNoaXBwaW5nT3B0aW9uLlNoaXBwaW5nT3B0aW9uVHlwZS5WYWx1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgc2VsZi5oYW5kbGVFZGl0TW9kZSA9IGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgIGlmIChkYXRhLkNhcnQuU2hpcG1lbnRzICE9IG51bGwgJiYgZGF0YS5DYXJ0LlNoaXBtZW50cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICBzZWxlY3RlZFNoaXBwaW5nT3B0aW9uID0gc2VsZi5zZWxlY3RlZFNoaXBwaW5nT3B0aW9uKCk7DQoNCiAgICAgICAgICAgICQoZGF0YS5DYXJ0LlNoaXBtZW50cykuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIHNoaXBtZW50ID0gdGhpczsNCiAgICAgICAgICAgICAgICB2YXIgZm91bmRTaGlwbWVudCA9IG51bGw7DQogICAgICAgICAgICAgICAgaWYgKHNoaXBtZW50LkxpbmVJRHMgIT0gbnVsbCkgew0KDQogICAgICAgICAgICAgICAgICAgIGZvdW5kTGluZUlkID0ga28udXRpbHMuYXJyYXlGaXJzdChzaGlwbWVudC5MaW5lSURzLCBmdW5jdGlvbiAoYSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEgPT09IHNlbGYuZXh0ZXJuYWxDYXJ0TGluZUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmRMaW5lSWQgIT0gbnVsbCkgew0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBTaGlwVG9BZGRyZXNzDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRTaGlwcGluZ09wdGlvbiA9PSAiMSIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hpcG1lbnQuU2hpcG1lbnRFZGl0TW9kZWwgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0aG9kcyA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNoaXBwaW5nTWV0aG9kcy5yZW1vdmVBbGwoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHNoaXBtZW50LlNoaXBtZW50RWRpdE1vZGVsLlNoaXBwaW5nTWV0aG9kcywgZnVuY3Rpb24gKGksIHYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaGlwcGluZ01ldGhvZHMucHVzaChuZXcgbWV0aG9kKHYuRGVzY3JpcHRpb24sIHYuRXh0ZXJuYWxJZCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc20gPSBrby51dGlscy5hcnJheUZpcnN0KHNlbGYuc2hpcHBpbmdNZXRob2RzKCksIGZ1bmN0aW9uIChhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYS5kZXNjcmlwdGlvbiA9PT0gc2hpcG1lbnQuU2hpcHBpbmdNZXRob2ROYW1lKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc20gIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaGlwcGluZ01ldGhvZChzbSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVtYWlsDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRTaGlwcGluZ09wdGlvbiA9PSAnMycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNoaXBwaW5nRW1haWwoc2hpcG1lbnQuRW1haWwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hpcHBpbmdFbWFpbENvbnRlbnQoc2hpcG1lbnQuRW1haWxDb250ZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBpZiAoc2VsZWN0ZWRTaGlwcGluZ09wdGlvbiA9PSAiMSIpIHsNCiAgICAgICAgICAgICAgICBzZWxmLmlzTGluZVNoaXBBbGwodHJ1ZSk7DQogICAgICAgICAgICAgICAgc2VsZi5pc0xpbmVTaGlwVG9FbWFpbChmYWxzZSk7DQogICAgICAgICAgICAgICAgc2VsZi5pc0xpbmVQaWNrVXAoZmFsc2UpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoc2VsZWN0ZWRTaGlwcGluZ09wdGlvbiA9PSAnMycpIHsNCiAgICAgICAgICAgICAgICBzZWxmLmlzTGluZVNoaXBUb0VtYWlsKHRydWUpOw0KICAgICAgICAgICAgICAgIHNlbGYuaXNMaW5lU2hpcEFsbChmYWxzZSk7DQogICAgICAgICAgICAgICAgc2VsZi5pc0xpbmVQaWNrVXAoZmFsc2UpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoc2VsZWN0ZWRTaGlwcGluZ09wdGlvbiA9PSAiMiIpIHsNCiAgICAgICAgICAgICAgICBzZWxmLmlzTGluZVNoaXBBbGwoZmFsc2UpOw0KICAgICAgICAgICAgICAgIHNlbGYuaXNMaW5lU2hpcFRvRW1haWwoZmFsc2UpOw0KICAgICAgICAgICAgICAgIHNlbGYuaXNMaW5lUGlja1VwKHRydWUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc2VsZi5zaG93U2hpcE9wdGlvbkNvbnRlbnQodHJ1ZSk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIERlbGl2ZXJ5Q2FydFZpZXdNb2RlbChkYXRhLCB1c2VyQWRkcmVzc2VzKSB7DQogICAgdmFyIHNlbGYgPSB0aGlzOw0KDQogICAgc2VsZi5jYXJ0TGluZXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTsNCiAgICBzZWxmLnVzZXJBZGRyZXNzZXMgPSBrby5vYnNlcnZhYmxlQXJyYXkoKTsNCiAgICBpZiAodXNlckFkZHJlc3NlcyAhPSBudWxsKSB7DQogICAgICAgIHNlbGYudXNlckFkZHJlc3Nlcyh1c2VyQWRkcmVzc2VzKTsNCiAgICB9DQoNCiAgICBzZWxmLmdldFVuaXF1ZUFkZHJlc3NJZCA9IGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICB2YXIgbmV3SWQgPSAxMDsNCiAgICAgICAgZm9yIChpID0gMTA7IGkgPCAxMDAwOyBpKyspIHsNCiAgICAgICAgICAgIHZhciBtYXRjaCA9IGtvLnV0aWxzLmFycmF5Rmlyc3Qoc2VsZi5jYXJ0TGluZXMoKSwgZnVuY3Rpb24gKGEpIHsNCiAgICAgICAgICAgICAgICBpZiAoYS5zaGlwcGluZ0FkZHJlc3MoKSAhPSBudWxsICYmIGEuc2hpcHBpbmdBZGRyZXNzKCkuZXh0ZXJuYWxJZCgpID09PSBpLnRvU3RyaW5nKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGE7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgaWYgKG1hdGNoID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICBuZXdJZCA9IGk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gbmV3SWQ7DQogICAgfQ0KDQogICAgLy9leGlzdGluZyBwcm9tbyBjb2Rlcw0KICAgIHNlbGYucHJvbW9Db2RlcyA9IGtvLm9ic2VydmFibGVBcnJheSgpOw0KICAgIGlmIChkYXRhICE9IG51bGwpIHsNCiAgICAgICAgJChkYXRhLlByb21vQ29kZXMpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgc2VsZi5wcm9tb0NvZGVzLnB1c2godGhpcyk7DQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8vcHJvbW8gY29kZSBpbnB1dA0KICAgIHNlbGYucHJvbW9Db2RlID0ga28ub2JzZXJ2YWJsZSgpOw0KICAgIHNlbGYuaGFzUHJvbW9Db2RlID0ga28uY29tcHV0ZWQoZnVuY3Rpb24gKCkgew0KICAgICAgICByZXR1cm4gc2VsZi5wcm9tb0NvZGUoKTsNCiAgICB9KTsNCg0KICAgIHNlbGYuc3ViVG90YWwgPSBrby5vYnNlcnZhYmxlKGRhdGEgIT0gbnVsbCA/IGRhdGEuU3VidG90YWwgOiAwKTsNCiAgICBzZWxmLnRheFRvdGFsID0ga28ub2JzZXJ2YWJsZShkYXRhICE9IG51bGwgPyBkYXRhLlRheFRvdGFsIDogMCk7DQogICAgc2VsZi50b3RhbCA9IGtvLm9ic2VydmFibGUoZGF0YSAhPSBudWxsID8gZGF0YS5Ub3RhbCA6IDApOw0KICAgIHNlbGYudG90YWxBbW91bnQgPSBrby5vYnNlcnZhYmxlKGRhdGEgIT0gbnVsbCA/IGRhdGEuVG90YWxBbW91bnQgOiAwKTsNCiAgICBzZWxmLmRpc2NvdW50ID0ga28ub2JzZXJ2YWJsZShkYXRhICE9IG51bGwgPyBkYXRhLkRpc2NvdW50IDogMCk7DQogICAgc2VsZi5zaGlwcGluZ1RvdGFsID0ga28ub2JzZXJ2YWJsZShkYXRhICE9IG51bGwgPyBkYXRhLlNoaXBwaW5nVG90YWwgOiAwKTsNCiAgICBzZWxmLmlzTGluZVNoaXBBbGwgPSBkYXRhICE9IG51bGwgJiYgZGF0YS5TaGlwbWVudHMgIT0gbnVsbCAmJiBkYXRhLlNoaXBtZW50cy5sZW5ndGggPiAxOw0KDQogICAgc2VsZi5zaGlwbWVudHMgPSBbXTsNCiAgICBpZiAoZGF0YSAhPSBudWxsKSB7DQogICAgICAgICQoZGF0YS5TaGlwbWVudHMpLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgc2VsZi5zaGlwbWVudHMucHVzaChuZXcgU2hpcG1lbnREYXRhKHRoaXMpKTsNCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgc2VsZi5wYXJ0aWVzID0gW107DQogICAgaWYgKGRhdGEgIT0gbnVsbCkgew0KICAgICAgICAkKGRhdGEuUGFydGllcykuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBzZWxmLnBhcnRpZXMucHVzaChuZXcgQWRkcmVzc1ZpZXdNb2RlbCh0aGlzKSk7DQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIGlmIChkYXRhICE9IG51bGwpIHsNCiAgICAgICAgJChkYXRhLkxpbmVzKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBsaW5lSXRlbSA9IG5ldyBEZWxpdmVyeUNhcnRMaW5lSXRlbURhdGEoZGF0YSwgdGhpcywgc2VsZik7DQoNCiAgICAgICAgICAgIGlmIChzZWxmLmlzTGluZVNoaXBBbGwpIHsNCiAgICAgICAgICAgICAgICB2YXIgc2hpcG1lbnQgPSBrby51dGlscy5hcnJheUZpcnN0KHNlbGYuc2hpcG1lbnRzLCBmdW5jdGlvbiAoYSkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoYS5saW5lSWRzICE9IG51bGwgJiYgYS5saW5lSWRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGtvLnV0aWxzLmFycmF5Rmlyc3QoYS5saW5lSWRzLCBmdW5jdGlvbiAobCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsID09PSBsaW5lSXRlbS5leHRlcm5hbENhcnRMaW5lSWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgIGlmIChzaGlwbWVudCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGxpbmVJdGVtLnNoaXBwaW5nTWV0aG9kKG5ldyBMaW5lSXRlbVNoaXBwaW5nTWV0aG9kKHNoaXBtZW50LnNoaXBwaW5nTWV0aG9kSWQsIHNoaXBtZW50LnNoaXBwaW5nTWV0aG9kTmFtZSkpDQoNCiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnR5ID0ga28udXRpbHMuYXJyYXlGaXJzdChzZWxmLnBhcnRpZXMsIGZ1bmN0aW9uIChhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYS5leHRlcm5hbElkKCkgPT09IHNoaXBtZW50LnBhcnR5SWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgIGlmIChwYXJ0eSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsaW5lSXRlbS5zaGlwcGluZ0FkZHJlc3MocGFydHkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBzZWxmLmNhcnRMaW5lcy5wdXNoKGxpbmVJdGVtKTsNCiAgICAgICAgfSk7DQogICAgfQ0KfQ0K
- ID: "6954b7c7-2487-423f-8600-436cb3b6dc0e"
  Hint: Size
  Value: 11415
- ID: "6f47a0a5-9c94-4b48-abeb-42d38def6054"
  Hint: Mime Type
  Value: "application/x-javascript"
- ID: "c06867fe-9a43-4c7d-b739-48780492d06f"
  Hint: Extension
  Value: js
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20190305T182633Z
    - ID: "5dd74568-4d4b-44c1-b513-0af5f4cda34f"
      Hint: __Created by
      Value: |
        sitecore\Admin
